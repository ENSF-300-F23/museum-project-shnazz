import mysql.connector
from mysql.connector import Error, errorcode

user = "admin"
password = "admin"
database = "museum"

def auth_check(username, password, database):
    while True:
        try:
            cnct = mysql.connector.connect(
            host = "localhost",
            user = username,
            password = password,
            database = database)
            crs = cnct.cursor(buffered=True)
            break

        except Error as error:
                    print(error)
                    if error.errno == errorcode.ER_ACCESS_DENIED_ERROR:
                        print("Incorrect Creditials")
                        username = input("Re-enter the username")
                        password = input("Re-enter the password")
                        continue
                    elif error.errno == errorcode.ER_BAD_DB_ERROR:
                        print("Invalid Database")
                        database = input("Re-enter the database")
                    else:
                        print(f"Error: '{error}'")
                        return cnct
    
    crs.execute(f"SHOW GRANTS FOR {username}@localhost")
    grants = crs.fetchall()
    output = grants[0][0].split(",")
    if " CREATE" in output:
        admin_actions(crs,cnct)
    elif " INSERT" in output:
        employee_actions(crs, cnct)

def show_tables(cursor):
    table = []
    cursor.execute("SHOW TABLES;")
    table_names = cursor.fetchall()
    for i in table_names:
        table.append(i[0])
    print(table)

def search_table(cursor, name):
    cursor.execute((f"SELECT * FROM {name}"))
    result = cursor.fetchall()
    for i in result:
        print(i)